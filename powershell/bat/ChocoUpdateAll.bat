
@echo off

:: BatchGotAdmin
:-------------------------------------
REM  --> Check for permissions
>nul 2>&1 "%SYSTEMROOT%\system32\cacls.exe" "%SYSTEMROOT%\system32\config\system"

REM --> If error flag set, we do not have admin.
if '%errorlevel%' NEQ '0' (
    echo Requesting administrative privileges...
    goto UACPrompt
) else ( goto gotAdmin )

:UACPrompt
    echo Set UAC = CreateObject^("Shell.Application"^) > "%temp%\getadmin.vbs"
    set params = %*:"=""
    echo UAC.ShellExecute "cmd.exe", "/c %~s0 %params%", "", "runas", 1 >> "%temp%\getadmin.vbs"

    "%temp%\getadmin.vbs"
    del "%temp%\getadmin.vbs"
    exit /B

:gotAdmin
    pushd "%CD%"
    CD /D "%~dp0"
powershell.exe -executionpolicy bypass -NoExit -encodedCommand cABhAHIAYQBtACAAKAANAAoAIAAgACAAIABbAHMAdAByAGkAbgBnAF0AJABVAHAAZABhAHQAZQBBAHAAcAA9ACcAdAByAHUAZQAnACwADQAKACAAIAAgACAAWwBzAHQAcgBpAG4AZwBdACQATgBlAHcAQQBwAHAAPQAnAGYAYQBsAHMAZQAnACwADQAKACAAIAAgACAAWwBzAHQAcgBpAG4AZwBdACQAQQBwAHAAbABpAGMAYQB0AGkAbwBuAHMAPQAnACcADQAKACkADQAKAA0ACgBpAGYAIAAoAFsARQBuAHYAaQByAG8AbgBtAGUAbgB0AF0AOgA6AEcAZQB0AEUAbgB2AGkAcgBvAG4AbQBlAG4AdABWAGEAcgBpAGEAYgBsAGUAKAAiAFUAcABkAGEAdABlAEEAcABwAGwAaQBjAGEAdABpAG8AbgBzACIALAAgACIAUAByAG8AYwBlAHMAcwAiACkAKQAgAHsADQAKACAAIAAgACAAJABVAHAAZABhAHQAZQBBAHAAcAAgAD0AIABbAEUAbgB2AGkAcgBvAG4AbQBlAG4AdABdADoAOgBHAGUAdABFAG4AdgBpAHIAbwBuAG0AZQBuAHQAVgBhAHIAaQBhAGIAbABlACgAIgBVAHAAZABhAHQAZQBBAHAAcABsAGkAYwBhAHQAaQBvAG4AcwAiACwAIAAiAFAAcgBvAGMAZQBzAHMAIgApAA0ACgB9AA0ACgBpAGYAIAAoAFsARQBuAHYAaQByAG8AbgBtAGUAbgB0AF0AOgA6AEcAZQB0AEUAbgB2AGkAcgBvAG4AbQBlAG4AdABWAGEAcgBpAGEAYgBsAGUAKAAiAE4AZQB3AEEAcABwAGwAaQBjAGEAdABpAG8AbgBzACIALAAgACIAUAByAG8AYwBlAHMAcwAiACkAKQAgAHsADQAKACAAIAAgACAAJABOAGUAdwBBAHAAcAAgAD0AIABbAEUAbgB2AGkAcgBvAG4AbQBlAG4AdABdADoAOgBHAGUAdABFAG4AdgBpAHIAbwBuAG0AZQBuAHQAVgBhAHIAaQBhAGIAbABlACgAIgBOAGUAdwBBAHAAcABsAGkAYwBhAHQAaQBvAG4AcwAiACwAIAAiAFAAcgBvAGMAZQBzAHMAIgApAA0ACgB9AA0ACgBpAGYAIAAoAFsARQBuAHYAaQByAG8AbgBtAGUAbgB0AF0AOgA6AEcAZQB0AEUAbgB2AGkAcgBvAG4AbQBlAG4AdABWAGEAcgBpAGEAYgBsAGUAKAAiAEEAcABwAGwAaQBjAGEAdABpAG8AbgBzACIALAAgACIAUAByAG8AYwBlAHMAcwAiACkAKQAgAHsADQAKACAAIAAgACAAJABBAHAAcABsAGkAYwBhAHQAaQBvAG4AcwAgAD0AIABbAEUAbgB2AGkAcgBvAG4AbQBlAG4AdABdADoAOgBHAGUAdABFAG4AdgBpAHIAbwBuAG0AZQBuAHQAVgBhAHIAaQBhAGIAbABlACgAIgBBAHAAcABsAGkAYwBhAHQAaQBvAG4AcwAiACwAIAAiAFAAcgBvAGMAZQBzAHMAIgApAA0ACgB9AA0ACgANAAoAdAByAHkAIAB7AA0ACgAJAFsATgBlAHQALgBTAGUAcgB2AGkAYwBlAFAAbwBpAG4AdABNAGEAbgBhAGcAZQByAF0AOgA6AFMAZQBjAHUAcgBpAHQAeQBQAHIAbwB0AG8AYwBvAGwAIAA9ACAAWwBFAG4AdQBtAF0AOgA6AFQAbwBPAGIAagBlAGMAdAAoAFsATgBlAHQALgBTAGUAYwB1AHIAaQB0AHkAUAByAG8AdABvAGMAbwBsAFQAeQBwAGUAXQAsACAAMwAwADcAMgApAA0ACgB9ACAAYwBhAHQAYwBoACAAWwBzAHkAcwB0AGUAbQAuAGUAeABjAGUAcAB0AGkAbwBuAF0AIAB7AA0ACgAJAHcAcgBpAHQAZQAtAGgAbwBzAHQAIAAiAC0AIABFAFIAUgBPAFIAOgAgAEMAbwB1AGwAZAAgAG4AbwB0ACAAaQBtAHAAbABlAG0AZQBuAHQAIABUAEwAUwAgADEALgAyACAAUwB1AHAAcABvAHIAdAAuACIADQAKAAkAdwByAGkAdABlAC0AaABvAHMAdAAgACIAIAAgAFQAaABpAHMAIABjAGEAbgAgAG8AYwBjAHUAcgAgAG8AbgAgAFcAaQBuAGQAbwB3AHMAIAA3ACAAZABlAHYAaQBjAGUAcwAgAGwAYQBjAGsAaQBuAGcAIABTAGUAcgB2AGkAYwBlACAAUABhAGMAawAgADEALgAiAA0ACgAJAHcAcgBpAHQAZQAtAGgAbwBzAHQAIAAiACAAIABQAGwAZQBhAHMAZQAgAGkAbgBzAHQAYQBsAGwAIAB0AGgAYQB0ACAAYgBlAGYAbwByAGUAIABwAHIAbwBjAGUAZQBkAGkAbgBnAC4AIgANAAoACQBlAHgAaQB0ACAAMQANAAoAfQANAAoADQAKAGYAdQBuAGMAdABpAG8AbgAgAEkAbgBzAHQAYQBsAGwAVQBwAGQAYQB0AGUAQwBoAG8AYwBvACAAewANAAoAIAAgACAAIAAkAGIAbwBvAGwAIAA9ACAAMAANAAoAIAAgACAAIABUAHIAeQAgAHsADQAKACAAIAAgACAAIAAgACAAIABpAGYAIAAoACEAKABUAGUAcwB0AC0AUABhAHQAaAAoACQAZQBuAHYAOgBDAGgAbwBjAG8AbABhAHQAZQB5AEkAbgBzAHQAYQBsAGwAIAArACAAIgBcAGMAaABvAGMAbwAuAGUAeABlACIAKQApACkAIAB7AA0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIABXAHIAaQB0AGUALQBIAG8AcwB0ACAAJwAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtACcAYABuAA0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIABpAGUAeAAgACgAKABuAGUAdwAtAG8AYgBqAGUAYwB0ACAAbgBlAHQALgB3AGUAYgBjAGwAaQBlAG4AdAApAC4ARABvAHcAbgBsAG8AYQBkAFMAdAByAGkAbgBnACgAJwBoAHQAdABwAHMAOgAvAC8AYwBoAG8AYwBvAGwAYQB0AGUAeQAuAG8AcgBnAC8AaQBuAHMAdABhAGwAbAAuAHAAcwAxACcAKQApAA0ACgAgACAAIAAgACAAIAAgACAAfQANAAoAIAAgACAAIAB9ACAAQwBhAHQAYwBoACAAewANAAoAIAAgACAAIAAgACAAIAAgAFcAcgBpAHQAZQAtAEgAbwBzAHQAIAAkACgAJABfAC4ARQB4AGMAZQBwAHQAaQBvAG4ALgBNAGUAcwBzAGEAZwBlACkADQAKACAAIAAgACAAIAAgACAAIABlAHgAaQB0ACAAMQANAAoAIAAgACAAIAB9AA0ACgB9AA0ACgANAAoASQBuAHMAdABhAGwAbABVAHAAZABhAHQAZQBDAGgAbwBjAG8ADQAKAA0ACgBXAHIAaQB0AGUALQBIAG8AcwB0ACAAJwAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtACcAYABuAA0ACgBpAGYAIAAoACQAVQBwAGQAYQB0AGUAQQBwAHAAIAAtAGwAaQBrAGUAIAAiAHQAcgB1AGUAIgApACAAewANAAoAIAAgACAAIAAmACAAIgAkAGUAbgB2ADoAQwBoAG8AYwBvAGwAYQB0AGUAeQBJAG4AcwB0AGEAbABsAFwAYwBoAG8AYwBvAC4AZQB4AGUAIgAgAHUAcABnAHIAYQBkAGUAIABhAGwAbAAgAC0AeQANAAoAIAAgACAAIABXAHIAaQB0AGUALQBIAG8AcwB0ACAAYABuAA0ACgB9ACAAZQBsAHMAZQAgAHsADQAKACAAIAAgACAAJgAgACIAJABlAG4AdgA6AEMAaABvAGMAbwBsAGEAdABlAHkASQBuAHMAdABhAGwAbABcAGMAaABvAGMAbwAuAGUAeABlACIAIAB1AHAAZwByAGEAZABlACAAYwBoAG8AYwBvAGwAYQB0AGUAeQAgAC0AeQANAAoAIAAgACAAIABXAHIAaQB0AGUALQBIAG8AcwB0ACAAYABuAA0ACgB9AA0ACgANAAoAaQBmACAAKAAkAE4AZQB3AEEAcABwACAALQBsAGkAawBlACAAIgB0AHIAdQBlACIAKQAgAHsADQAKACAAIAAgACAAaQBmACAAKAAkAEEAcABwAGwAaQBjAGEAdABpAG8AbgBzACAALQBuAGUAIAAiACAAIgApACAAewANAAoAIAAgACAAIAAgACAAIAAgACQAQQBwAHAAbABpAGMAYQB0AGkAbwBuAHMALgBTAHAAbABpAHQAKAAiACAAIgApACAAfAAgACUAIAB7AA0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIABpAGYAIAAoACEAKAAkAF8AIAAtAGwAaQBrAGUAIAAiACAAIgApACAALQBhAG4AZAAgACQAXwAuAGwAZQBuAGcAdABoACAALQBuAGUAIAAwACkAIAB7AA0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAFcAcgBpAHQAZQAtAEgAbwBzAHQAIAAnAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0AJwBgAG4ADQAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAVwByAGkAdABlAC0ASABvAHMAdAAgAEkAbgBzAHQAYQBsAGwAaQBuAGcAIAAkAF8AIAANAAoAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAmACAAIgAkAGUAbgB2ADoAQwBoAG8AYwBvAGwAYQB0AGUAeQBJAG4AcwB0AGEAbABsAFwAYwBoAG8AYwBvAC4AZQB4AGUAIgAgAGkAbgBzAHQAYQBsAGwAIAAkAF8AIAAtAHkADQAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgAH0ADQAKACAAIAAgACAAIAAgACAAIAB9AA0ACgAgACAAIAAgAH0AIABlAGwAcwBlACAAewANAAoAIAAgACAAIAAgACAAIAAgACQAVgBlAHIAcwBpAG8AbgBDAGgAbwBjAG8AIAA9ACAAWwBTAHkAcwB0AGUAbQAuAEQAaQBhAGcAbgBvAHMAdABpAGMAcwAuAEYAaQBsAGUAVgBlAHIAcwBpAG8AbgBJAG4AZgBvAF0AOgA6AEcAZQB0AFYAZQByAHMAaQBvAG4ASQBuAGYAbwAoACQAZQBuAHYAOgBDAGgAbwBjAG8AbABhAHQAZQB5AEkAbgBzAHQAYQBsAGwAIAArACAAIgBcAGMAaABvAGMAbwAuAGUAeABlACIAKQAuAFAAcgBvAGQAdQBjAHQAVgBlAHIAcwBpAG8AbgANAAoAIAAgACAAIAAgACAAIAAgAFcAcgBpAHQAZQAtAEgAbwBzAHQAIAAnAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0AJwBgAG4ADQAKACAAIAAgACAAIAAgACAAIABXAHIAaQB0AGUALQBIAG8AcwB0ACAASQBuAHMAdABhAGwAbABpAG4AZwANAAoAIAAgACAAIAAgACAAIAAgAFcAcgBpAHQAZQAtAEgAbwBzAHQAIABDAGgAbwBjAG8AbABhAHQAZQB5ACAAdgAkAFYAZQByAHMAaQBvAG4AQwBoAG8AYwBvAA0ACgAgACAAIAAgACAAIAAgACAAVwByAGkAdABlAC0ASABvAHMAdAAgAFAAYQBjAGsAYQBnAGUAIABuAGEAbQBlACAAaQBzACAAcgBlAHEAdQBpAHIAZQBkAC4AIABQAGwAZQBhAHMAZQAgAHAAYQBzAHMAIABhAHQAIABsAGUAYQBzAHQAIABvAG4AZQAgAHAAYQBjAGsAYQBnAGUAIABuAGEAbQBlACAAdABvACAAaQBuAHMAdABhAGwAbAAuAGAAbgANAAoAIAAgACAAIAB9AA0ACgB9AA0ACgBXAHIAaQB0AGUALQBIAG8AcwB0ACAAYABuACcALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAnAA0ACgBlAHgAaQB0ACAAMAA=
