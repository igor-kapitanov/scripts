
@echo off

:: BatchGotAdmin
:-------------------------------------
REM  --> Check for permissions
>nul 2>&1 "%SYSTEMROOT%\system32\cacls.exe" "%SYSTEMROOT%\system32\config\system"

REM --> If error flag set, we do not have admin.
if '%errorlevel%' NEQ '0' (
    echo Requesting administrative privileges...
    goto UACPrompt
) else ( goto gotAdmin )

:UACPrompt
    echo Set UAC = CreateObject^("Shell.Application"^) > "%temp%\getadmin.vbs"
    set params = %*:"=""
    echo UAC.ShellExecute "cmd.exe", "/c %~s0 %params%", "", "runas", 1 >> "%temp%\getadmin.vbs"

    "%temp%\getadmin.vbs"
    del "%temp%\getadmin.vbs"
    exit /B

:gotAdmin
    pushd "%CD%"
    CD /D "%~dp0"
powershell.exe -executionpolicy bypass -NoExit -encodedCommand DQAKAFcAcgBpAHQAZQAtAEgAbwBzAHQAIAAiACoAKgAqACoAKgAgAEkAbgBzAHQAYQBsAGwAIABBAGQAbwBiAGUAIABBAGMAcgBvAGIAYQB0ACAAUAByAG8AIAAqACoAKgAqACoAIgAgAC0ARgBvAHIAZQBnAHIAbwB1AG4AZABDAG8AbABvAHIAIABHAHIAZQBlAG4ADQAKAAkAIwAjACMAIwAjACMAIwBTAGMAcgBpAHAAdAAgAFMAdABhAHIAdABzACMAIwAjACMAIwAjACMAIwAjAA0ACgANAAoACQAjACAAUwBpAGwAZQBuAHQAIABJAG4AcwB0AGEAbABsACAAQQBkAG8AYgBlACAAQQBjAHIAbwBiAGEAdAANAAoADQAKAAkAIwAgAFAAYQB0AGgAIABmAG8AcgAgAHQAaABlACAAdwBvAHIAawBkAGkAcgANAAoACQAkAHcAbwByAGsAZABpAHIAIAA9ACAAIgBjADoAXAB0AGUAbQBwAFwAIgANAAoADQAKAAkAIwAgAEMAaABlAGMAawAgAGkAZgAgAHcAbwByAGsAIABkAGkAcgBlAGMAdABvAHIAeQAgAGUAeABpAHMAdABzACAAaQBmACAAbgBvAHQAIABjAHIAZQBhAHQAZQAgAGkAdAANAAoACQBJAGYAIAAoAFQAZQBzAHQALQBQAGEAdABoACAALQBQAGEAdABoACAAJAB3AG8AcgBrAGQAaQByACAALQBQAGEAdABoAFQAeQBwAGUAIABDAG8AbgB0AGEAaQBuAGUAcgApAHsADQAKAAkAVwByAGkAdABlAC0ASABvAHMAdAAgACIAJAB3AG8AcgBrAGQAaQByACAAYQBsAHIAZQBhAGQAeQAgAGUAeABpAHMAdABzACIAIAAtAEYAbwByAGUAZwByAG8AdQBuAGQAQwBvAGwAbwByACAAUgBlAGQADQAKAAkAfQAgAEUATABTAEUAIAB7AA0ACgAJAE4AZQB3AC0ASQB0AGUAbQAgAC0AUABhAHQAaAAgACQAdwBvAHIAawBkAGkAcgAgAC0ASQB0AGUAbQBUAHkAcABlACAAZABpAHIAZQBjAHQAbwByAHkADQAKAAkAfQANAAoADQAKAAkAIwAgAEQAbwB3AG4AbABvAGEAZAAgAHQAaABlACAAaQBuAHMAdABhAGwAbABlAHIADQAKAAkAJABVAFIATAAgAD0AIAAiAGgAdAB0AHAAcwA6AC8ALwB0AHIAaQBhAGwAcwAuAGEAZABvAGIAZQAuAGMAbwBtAC8AQQBkAG8AYgBlAFAAcgBvAGQAdQBjAHQAcwAvAEEAUABSAE8ALwBBAGMAcgBvAGIAYQB0AF8ASABlAGwAcABYAC8AdwBpAG4AMwAyAC8AQQBjAHIAbwBiAGEAdABfAEQAQwBfAFcAZQBiAF8AeAA2ADQAXwBXAFcATQBVAEkALgB6AGkAcAAiAA0ACgAJACQAZABlAHMAdABpAG4AYQB0AGkAbwBuACAAPQAgACIAJAB3AG8AcgBrAGQAaQByAFwAYQBjAHIAbwBiAGEAdAAuAHoAaQBwACIADQAKAAkASQBuAHYAbwBrAGUALQBXAGUAYgBSAGUAcQB1AGUAcwB0ACAALQBVAHIAaQAgACQAVQBSAEwAIAAtAE8AdQB0AEYAaQBsAGUAIAAkAGQAZQBzAHQAaQBuAGEAdABpAG8AbgANAAoACQANAAoACQAjAHUAbgB6AGkAcAAgAHQAaABlACAAYQByAGMAaABpAHYAZQANAAoACQBFAHgAcABhAG4AZAAtAEEAcgBjAGgAaQB2AGUAIAAtAEwAaQB0AGUAcgBhAGwAUABhAHQAaAAgACcAQwA6AFwAdABlAG0AcABcAGEAYwByAG8AYgBhAHQALgB6AGkAcAAnACAALQBEAGUAcwB0AGkAbgBhAHQAaQBvAG4AUABhAHQAaAAgAEMAOgBcAHQAZQBtAHAAXAANAAoADQAKAAkAIwAgAFMAdABhAHIAdAAgAHQAaABlACAAaQBuAHMAdABhAGwAbABhAHQAaQBvAG4ADQAKAAkAUwB0AGEAcgB0AC0AUAByAG8AYwBlAHMAcwAgAC0ARgBpAGwAZQBQAGEAdABoACAAIgBDADoAXAB0AGUAbQBwAFwAQQBkAG8AYgBlACAAQQBjAHIAbwBiAGEAdABcAFMAZQB0AHUAcAAuAGUAeABlACIAIAAtAEEAcgBnAHUAbQBlAG4AdABMAGkAcwB0ACAAIgAvAHMAQQBsAGwAIAAvAHIAcwAgAC8AcgBwAHMAIAAvAG0AcwBpACAALwBuAG8AcgBlAHMAdABhAHIAdAAgAC8AcQB1AGkAZQB0ACAARQBVAEwAQQBfAEEAQwBDAEUAUABUAD0AWQBFAFMAIgAgAC0AVgBlAHIAYgAgAFIAdQBuAEEAcwANAAoADQAKAA==
